<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Movie and Show Booking — Book Movies</title>
      <link rel="stylesheet" href="css/styles.css" />
   </head>
   <body>
      <div class="background-wrapper" aria-hidden="true">
         <video
            id="bgVideo"
            class="background-video"
            src="video/BG.mp4"
            autoplay
            muted
            loop
            playsinline></video>
      </div>
      <div class="background-overlay" aria-hidden="true"></div>
      <header class="site-header">
         <div class="container header-inner">
            <div class="brand">
               <h1 class="logo">Movie and Show Booking</h1>
               <p class="tag">Discover movies • Pick showtimes • Book seats</p>
            </div>
            <nav class="main-nav" aria-label="Main navigation">
               <a href="#" class="nav-link" data-view="now">Now Showing</a>
               <a href="#" class="nav-link" data-view="coming">Coming Soon</a>
               <a href="#" class="nav-link" data-view="admin">Admin Panel</a>
               <a href="#" class="nav-cta" data-view="bookings">My Bookings</a>
               <button type="button" class="btn btn-ghost btn-sm" id="authToggle">
                  Sign In
               </button>
            </nav>
         </div>
      </header>

      <section
         id="heroCarousel"
         class="hero-carousel hidden"
         aria-label="Featured movies">
         <div class="hero-carousel__viewport">
            <div
               class="hero-carousel__slides"
               id="heroCarouselSlides"
               aria-live="polite"></div>
            <div class="hero-carousel__controls">
               <button
                  type="button"
                  class="hero-carousel__nav"
                  id="heroCarouselPrev"
                  aria-label="View previous featured movie">
                  <span aria-hidden="true">&lt;</span>
               </button>
               <div
                  class="hero-carousel__dots"
                  id="heroCarouselDots"
                  role="tablist"
                  aria-label="Featured movie navigation"></div>
               <button
                  type="button"
                  class="hero-carousel__nav"
                  id="heroCarouselNext"
                  aria-label="View next featured movie">
                  <span aria-hidden="true">&gt;</span>
               </button>
            </div>
         </div>
      </section>

      <main class="container">
         <section id="view-now" class="view-section">
            <h2>Now Showing</h2>
            <div id="moviesGrid" class="movies-grid" aria-live="polite"></div>
         </section>

         <section id="view-coming" class="view-section hidden">
            <h2>Coming Soon</h2>
            <div id="comingGrid" class="movies-grid" aria-live="polite"></div>
         </section>

         <section id="view-bookings" class="view-section hidden">
            <h2>My Bookings</h2>
            <div id="bookingsAuthPrompt" class="auth-prompt hidden"></div>
            <div id="bookingsContainer" class="bookings-container"></div>
         </section>

         <section
            id="view-admin"
            class="view-section hidden"
            aria-labelledby="adminHeading">
            <!-- <h2 id="adminHeading">Admin Panel</h2> -->
            <div class="admin-panel">
               <div class="admin-auth-card">
                  <form id="adminLoginForm" class="admin-form" autocomplete="on">
                     <div class="field-group">
                        <label for="adminEmail">Email</label>
                        <input id="adminEmail" name="email" type="email" required />
                     </div>
                     <div class="field-group">
                        <label for="adminPassword">Password</label>
                        <input
                           id="adminPassword"
                           name="password"
                           type="password"
                           required />
                     </div>

                     <div class="field-group hidden" id="adminDisplayNameGroup">
                        <label for="adminDisplayName">Display name</label>
                        <input
                           id="adminDisplayName"
                           name="displayName"
                           type="text"
                           placeholder="Optional" />
                     </div>

                     <div class="form-actions">
                        <button
                           type="submit"
                           id="adminAuthSubmit"
                           class="btn btn-primary">
                           Sign In
                        </button>
                        <button
                           type="button"
                           id="adminResetPassword"
                           class="btn btn-ghost">
                           Reset Password
                        </button>
                     </div>
                     <button
                        type="button"
                        id="adminToggleMode"
                        class="btn btn-ghost btn-sm">
                        Need an account? Sign up
                     </button>
                     <p id="adminAuthMessage" class="form-message" role="alert"></p>
                  </form>
                  <div id="adminSession" class="admin-session hidden">
                     <p class="session-text">
                        Signed in as <span id="adminUserEmail"></span>
                     </p>
                     <div class="form-actions">
                        <button id="adminSignOut" type="button" class="btn btn-ghost">
                           Sign out
                        </button>
                        <button
                           id="adminRefreshData"
                           type="button"
                           class="btn btn-primary">
                           Refresh data
                        </button>
                     </div>
                  </div>
               </div>

               <div id="adminDashboard" class="admin-dashboard hidden">
                  <div class="admin-tabs" role="tablist">
                     <button
                        type="button"
                        class="admin-tab active"
                        data-admin-tab="movies">
                        Movies
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="carousel">
                        Carousel
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="upcoming">
                        Upcoming
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="bookings">
                        Bookings
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="media">
                        Media
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="config">
                        Configuration
                     </button>
                     <button type="button" class="admin-tab" data-admin-tab="users">
                        Users
                     </button>
                  </div>
                  <div class="admin-panels">
                     <section class="admin-panel-section" data-admin-panel="movies">
                        <header class="admin-panel-header">
                           <h3>Manage Movies</h3>
                           <p>
                              Publish, edit, or archive films that appear on the Now
                              Showing grid.
                           </p>
                        </header>
                        <form id="adminMovieForm" class="admin-form" autocomplete="off">
                           <input type="hidden" id="adminMovieId" name="movieId" />
                           <div class="form-grid">
                              <label
                                 >Title
                                 <input name="title" required />
                              </label>
                              <label
                                 >Runtime
                                 <input name="runtime" placeholder="e.g. 2h 10m" />
                              </label>
                              <label
                                 >Rating
                                 <input name="rating" placeholder="PG-13" />
                              </label>
                           </div>
                           <div class="form-grid">
                              <label
                                 >Base Price ($)
                                 <input name="price" type="number" step="0.01" min="0" />
                              </label>
                              <label
                                 >Release Year
                                 <input
                                    name="releaseYear"
                                    type="number"
                                    min="1900"
                                    max="2100" />
                              </label>
                              <label
                                 >IMDb Rating
                                 <input
                                    name="imdbRating"
                                    type="number"
                                    min="0"
                                    max="10"
                                    step="0.1" />
                              </label>
                           </div>
                           <label
                              >Showtimes (comma separated)
                              <input name="showtimes" placeholder="10:30, 13:00" />
                           </label>
                           <label
                              >Genres (comma separated)
                              <input name="genres" placeholder="Sci-Fi, Adventure" />
                           </label>
                           <label
                              >Cast (comma separated)
                              <input name="cast" placeholder="Actor 1, Actor 2" />
                           </label>
                           <label
                              >Synopsis
                              <textarea name="synopsis" rows="3"></textarea>
                           </label>
                           <div class="form-grid">
                              <label
                                 >Director
                                 <input name="director" />
                              </label>
                              <label
                                 >Producer
                                 <input name="producer" />
                              </label>
                           </div>
                           <label
                              >Poster Image
                              <input
                                 name="posterFile"
                                 id="adminMoviePosterFile"
                                 type="file"
                                 accept="image/*" />
                           </label>
                           <input
                              type="hidden"
                              name="posterUrl"
                              id="adminMoviePosterUrl" />
                           <input
                              type="hidden"
                              name="posterPublicId"
                              id="adminMoviePosterPublicId" />
                           <div class="form-grid">
                              <label
                                 >Front Row Multiplier
                                 <input
                                    name="multiplierFront"
                                    type="number"
                                    step="0.01"
                                    min="0"
                                    placeholder="1.5" />
                              </label>
                              <label
                                 >Middle Row Multiplier
                                 <input
                                    name="multiplierMiddle"
                                    type="number"
                                    step="0.01"
                                    min="0"
                                    placeholder="1.0" />
                              </label>
                              <label
                                 >Back Row Multiplier
                                 <input
                                    name="multiplierBack"
                                    type="number"
                                    step="0.01"
                                    min="0"
                                    placeholder="0.75" />
                              </label>
                           </div>
                           <div class="form-actions">
                              <button type="submit" class="btn btn-primary">
                                 Save Movie
                              </button>
                              <button
                                 type="button"
                                 id="adminMovieFormReset"
                                 class="btn btn-ghost">
                                 Clear
                              </button>
                           </div>
                           <p class="form-message" id="adminMovieFormMessage"></p>
                        </form>
                        <div class="admin-table-wrap">
                           <table id="adminMoviesTable">
                              <thead>
                                 <tr>
                                    <th>Title</th>
                                    <th>Showtimes</th>
                                    <th>Status</th>
                                    <th>Updated</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>

                     <section
                        class="admin-panel-section hidden"
                        data-admin-panel="carousel">
                        <header class="admin-panel-header">
                           <h3>Homepage Carousel</h3>
                           <p>Upload images that appear in the hero carousel.</p>
                        </header>
                        <form
                           id="adminCarouselForm"
                           class="admin-form"
                           autocomplete="off">
                           <input type="hidden" id="adminCarouselId" name="carouselId" />
                           <label
                              >Carousel Image
                              <input
                                 name="posterFile"
                                 id="adminCarouselPosterFile"
                                 type="file"
                                 accept="image/*"
                                 required />
                           </label>
                           <input
                              type="hidden"
                              name="posterUrl"
                              id="adminCarouselPosterUrl" />
                           <input
                              type="hidden"
                              name="posterPublicId"
                              id="adminCarouselPosterPublicId" />
                           <input
                              type="hidden"
                              name="status"
                              id="adminCarouselStatus"
                              value="published" />
                           <input
                              type="hidden"
                              name="title"
                              id="adminCarouselTitle"
                              value="Carousel Slide" />
                           <div class="form-actions">
                              <button type="submit" class="btn btn-primary">
                                 Upload Image
                              </button>
                              <button
                                 type="button"
                                 id="adminCarouselFormReset"
                                 class="btn btn-ghost">
                                 Clear
                              </button>
                           </div>
                           <p class="form-message" id="adminCarouselFormMessage"></p>
                        </form>
                        <div class="admin-table-wrap">
                           <table id="adminCarouselTable">
                              <thead>
                                 <tr>
                                    <th>Title</th>
                                    <th>Status</th>
                                    <th>Priority</th>
                                    <th>Updated</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>

                     <section
                        class="admin-panel-section hidden"
                        data-admin-panel="upcoming">
                        <header class="admin-panel-header">
                           <h3>Manage Upcoming Releases</h3>
                           <p>Control what appears in the Coming Soon carousel.</p>
                        </header>
                        <form id="adminUpcomingForm" class="admin-form">
                           <input type="hidden" id="adminUpcomingId" name="upcomingId" />
                           <div class="form-grid">
                              <label
                                 >Title
                                 <input name="title" required />
                              </label>
                              <label
                                 >Release Date
                                 <input name="releaseDate" type="date" required />
                              </label>
                              <label
                                 >Status
                                 <select name="status">
                                    <option value="draft">Draft</option>
                                    <option value="published">Published</option>
                                 </select>
                              </label>
                           </div>
                           <label
                              >Summary
                              <textarea
                                 name="summary"
                                 rows="3"
                                 placeholder="Short teaser"></textarea>
                           </label>
                           <label
                              >Poster Image
                              <input
                                 name="posterFile"
                                 id="adminUpcomingPosterFile"
                                 type="file"
                                 accept="image/*" />
                           </label>
                           <input
                              type="hidden"
                              name="posterUrl"
                              id="adminUpcomingPosterUrl" />
                           <input
                              type="hidden"
                              name="posterPublicId"
                              id="adminUpcomingPosterPublicId" />
                           <div class="form-actions">
                              <button type="submit" class="btn btn-primary">
                                 Save Upcoming
                              </button>
                              <button
                                 type="button"
                                 id="adminUpcomingFormReset"
                                 class="btn btn-ghost">
                                 Clear
                              </button>
                           </div>
                           <p class="form-message" id="adminUpcomingFormMessage"></p>
                        </form>
                        <div class="admin-table-wrap">
                           <table id="adminUpcomingTable">
                              <thead>
                                 <tr>
                                    <th>Title</th>
                                    <th>Release</th>
                                    <th>Status</th>
                                    <th>Updated</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>

                     <section
                        class="admin-panel-section hidden"
                        data-admin-panel="bookings">
                        <header class="admin-panel-header">
                           <h3>Manage Bookings</h3>
                           <p>
                              View and manage all user bookings across all movies and showtimes.
                           </p>
                        </header>
                        <div class="admin-table-wrap">
                           <table id="adminBookingsTable">
                              <thead>
                                 <tr>
                                    <th>User</th>
                                    <th>Movie</th>
                                    <th>Showtime</th>
                                    <th>Seats</th>
                                    <th>Total</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                    <th>Booked</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>

                     <section class="admin-panel-section hidden" data-admin-panel="media">
                        <header class="admin-panel-header">
                           <h3>Media Library</h3>
                           <p>Upload artwork and hero videos directly to Cloudinary.</p>
                        </header>
                        <form
                           id="adminMediaUploadForm"
                           class="admin-form"
                           enctype="multipart/form-data">
                           <div class="form-grid">
                              <label
                                 >Asset Type
                                 <select name="type" required>
                                    <option value="poster">Poster</option>
                                    <option value="backgroundVideo">
                                       Background Video
                                    </option>
                                    <option value="trailer">Trailer</option>
                                 </select>
                              </label>
                              <label
                                 >Associated Movie ID (optional)
                                 <input name="movieId" placeholder="movie ObjectId" />
                              </label>
                              <label
                                 >Visibility
                                 <select name="visibility">
                                    <option value="public">Public</option>
                                    <option value="private">Private</option>
                                 </select>
                              </label>
                           </div>
                           <label
                              >Choose File
                              <input
                                 id="adminMediaFile"
                                 name="file"
                                 type="file"
                                 accept="image/*,video/*"
                                 required />
                           </label>
                           <div class="form-actions">
                              <button type="submit" class="btn btn-primary">
                                 Upload
                              </button>
                              <button
                                 type="button"
                                 id="adminMediaReset"
                                 class="btn btn-ghost">
                                 Reset
                              </button>
                           </div>
                           <p class="form-message" id="adminMediaMessage"></p>
                        </form>
                        <div class="admin-table-wrap">
                           <table id="adminMediaTable">
                              <thead>
                                 <tr>
                                    <th>Preview</th>
                                    <th>Type</th>
                                    <th>Movie</th>
                                    <th>Visibility</th>
                                    <th>Updated</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>

                     <section
                        class="admin-panel-section hidden"
                        data-admin-panel="config">
                        <header class="admin-panel-header">
                           <h3>Configuration</h3>
                           <p>
                              Global settings for branding, seat pricing, and hero media.
                           </p>
                        </header>
                        <form id="adminConfigForm" class="admin-form">
                           <div class="form-grid">
                              <label
                                 >Brand Title
                                 <input
                                    name="brandTitle"
                                    placeholder="Movie and Show Booking" />
                              </label>
                              <label
                                 >Tagline
                                 <input name="tagline" placeholder="Discover movies..." />
                              </label>
                              <label
                                 >Support Email
                                 <input
                                    name="supportEmail"
                                    type="email"
                                    placeholder="support@example.com" />
                              </label>
                           </div>
                           <div class="form-grid">
                              <label
                                 >Front Row Multiplier
                                 <input
                                    name="seatFront"
                                    type="number"
                                    step="0.01"
                                    min="0" />
                              </label>
                              <label
                                 >Middle Row Multiplier
                                 <input
                                    name="seatMiddle"
                                    type="number"
                                    step="0.01"
                                    min="0" />
                              </label>
                              <label
                                 >Back Row Multiplier
                                 <input
                                    name="seatBack"
                                    type="number"
                                    step="0.01"
                                    min="0" />
                              </label>
                           </div>
                           <label
                              >Background Video Asset ID
                              <input
                                 name="backgroundVideoId"
                                 placeholder="Cloudinary public_id" />
                           </label>
                           <div class="form-actions">
                              <button type="submit" class="btn btn-primary">
                                 Save Configuration
                              </button>
                              <button
                                 type="button"
                                 id="adminConfigReset"
                                 class="btn btn-ghost">
                                 Reset
                              </button>
                           </div>
                           <p class="form-message" id="adminConfigMessage"></p>
                        </form>
                     </section>

                     <section class="admin-panel-section hidden" data-admin-panel="users">
                        <header class="admin-panel-header">
                           <h3>User Management</h3>
                           <p>
                              Review registered accounts and promote new administrators.
                           </p>
                        </header>
                        <div class="admin-table-wrap">
                           <table id="adminUsersTable">
                              <thead>
                                 <tr>
                                    <th>Email</th>
                                    <th>Display Name</th>
                                    <th>Role</th>
                                    <th>Last Sign-in</th>
                                    <th>Actions</th>
                                 </tr>
                              </thead>
                              <tbody></tbody>
                           </table>
                        </div>
                     </section>
                  </div>
               </div>
            </div>
         </section>
      </main>

      <!-- Seat selection modal -->
      <div id="modalOverlay" class="modal-overlay hidden" role="dialog" aria-modal="true">
         <div class="modal">
            <button id="closeModal" class="modal-close" aria-label="Close">✕</button>
            <div id="modalContent"></div>
         </div>
      </div>

      <template id="movieCardTemplate">
         <article class="movie-card">
            <div class="poster">
               <img class="poster-img" alt="" />
               <div class="poster-title"></div>
               <div class="poster-upload">
                  <input
                     type="file"
                     class="poster-input"
                     accept="image/*"
                     aria-label="Upload movie poster" />
                  <button class="btn btn-ghost btn-sm upload-poster">
                     Upload Poster
                  </button>
               </div>
            </div>
            <div class="card-body">
               <h3 class="movie-title"></h3>
               <p class="meta"></p>
               <div class="card-actions">
                  <button class="btn btn-primary select-seats">Select Seats</button>
                  <button class="btn btn-ghost view-details">View Details</button>
               </div>
            </div>
         </article>
      </template>

      <template id="ticketTemplate">
         <div class="ticket-card">
            <div class="ticket-thumb"></div>
            <div class="ticket-info">
               <h4 class="ticket-title"></h4>
               <div class="ticket-meta"></div>
               <div class="ticket-actions">
                  <button class="btn btn-ghost btn-sm btn-danger cancel-ticket">
                     Cancel
                  </button>
               </div>
            </div>
         </div>
      </template>

      <footer class="site-footer">
         <div class="container footer-inner">
            <div class="footer-brand">
               <h3 class="footer-logo">Movie & Show Booking</h3>
               <p class="footer-tagline">
                  Curating the best blockbusters, indie gems, and live spectacles for your
                  next night out.
               </p>
               <div class="footer-badges">
                  <span class="badge">Secure Bookings</span>
                  <span class="badge">24/7 Support</span>
                  <span class="badge">Verified Venues</span>
               </div>
            </div>
            <div class="footer-links">
               <nav aria-label="Footer navigation">
                  <a href="#" data-view="now">Now Streaming</a>
                  <a href="#" data-view="coming">Coming Soon</a>
                  <a href="#" data-view="bookings">My Tickets</a>
               </nav>
               <div class="footer-contact">
                  <a href="mailto:samsul261103@gmail.com">samsul261103@gmail.com</a>
                  <span>01400874851</span>
               </div>
            </div>
            <div class="footer-social">
               <p class="footer-social-heading">Follow the highlights</p>
               <div class="footer-social-links" role="list">
                  <a
                     href="https://instagram.com"
                     target="_blank"
                     rel="noopener"
                     role="listitem"
                     >Instagram</a
                  >
                  <a
                     href="https://twitter.com"
                     target="_blank"
                     rel="noopener"
                     role="listitem"
                     >X / Twitter</a
                  >
                  <a
                     href="https://youtube.com"
                     target="_blank"
                     rel="noopener"
                     role="listitem"
                     >YouTube</a
                  >
               </div>
               <div class="footer-meta">
                  <span>&copy; <span id="year"></span> Movie & Show Booking</span>
               </div>
            </div>
         </div>
      </footer>

      <!-- Toast Notification System -->
      <div id="toastBackdrop" class="toast-backdrop"></div>
      <div
         id="toastContainer"
         class="toast-container"
         aria-live="polite"
         aria-atomic="true"></div>

      <script>
         // Detect if running in Electron
         const isElectron = window.electron && window.electron.isElectron;

         window.__APP_CONFIG__ = window.__APP_CONFIG__ || {
            apiBaseUrl:
               window.localStorage.getItem("msb_api_base") ||
               "https://showbooking-iqzi.onrender.com/api",
         };

         // Log the detected environment
         if (isElectron) {
            console.log(
               "[Config] Running in Electron desktop app - using remote backend"
            );
         } else {
            console.log("[Config] Running in web browser - using remote backend");
         }
         console.log("[Config] API Base URL:", window.__APP_CONFIG__.apiBaseUrl);
      </script>
      <script src="js/script.js"></script>
   </body>
</html>
